# 1. 네트워크의 큰 그림

## 1-1. 네트워크의 기본구조

### 네트워크 토폴로지

네트워크는 노드와 간선으로 이루어진 자료구조라는 점에서 **그래프**의 형태를 띤다고 할 수 있다.

네트워크 상에서 노드와 노드 사이의 연결 구조는 **네트워크 토폴로지(network topology)** 라고 부른다. 노드가 어떻게 연결되고 배치되느냐에 따라 망형, 트리형, 링형 등의 유형으로 나눌 수 있다.

(그림)

### 호스트

위의 네트워크 토폴로지에서 네트워크의 가장자리에 위치하면서 네트워크를 통해 주고받는 정보를 최초로 송신하고 최종 수신하는 노드를 **호스트(host)** 라고 부른다.

노트북과 구글 두 호스트가 각각 호스트로서 정보를 주고 받는다고 했을 때

1. 노트북이 구글의 서버 컴퓨터에게 웹 페이지를 가져다 달라는 요청을 보낸다.
2. 구글의 서버 컴퓨터가 노트북에게 웹 페이지로 응답한다.

이 과정에서 노트북처럼 **요청(request)** 을 보내는 호스트를 **클라이언트(client)** , 구글의 서버 컴퓨터처럼 **응답(response)** 을 보내는 호스트를 **서버(server)** 라고 한다.

네트워크를 그래프로 간주했을 때 중간에 위치한 노드, 즉 중간노드는 가장자리에 위치한 호스트가 주고받는 정보들을 안정적으로 전송하는 역할을 하는데, 이러한 장비들로는 **스위치**, **라우터**, **공유기** 등이 해당된다.

### LAN과 WAN

네트워크는 규모에 따라 LAN과 WAN 으로 나뉜다.

**LAN(Local Area Network)**: (근거리 네트워크) 가정이나 기업처럼 비교적 가까운 거리를 연결하는 한정된 공간에서의 네트워크. 모든 네트워크 기기들이 같은 LAN 네트워크 안에서만 정보를 주고받는 것이 아니라 LAN 간의 통신도 빈번하다.

**WAN(Wide Area Network)**: (원거리 네트워크) WAN 을 통해 LAN 간 통신이 이루어지며 인터넷을 가능하게 만드는 네트워크. WAN 은 일반적으로 KT, LG U+, SK 브로드밴드 처럼 **ISP(Internet Service Provider)** 라는 인터넷 서비스 업체가 구축하고 관리한다.

### 패킷 교환 네트워크

네트워크를 통해 주고받는 데이터는 한 번에 송수신되지 않고 여러 데이터로 쪼개져서 송수신되는데, 이렇게 네트워크를 통해 송수신되는 데이터의 단위를 **패킷(packet)** 이라고 한다. 오늘날의 네트워크는 패킷 단위로 주고받는 정보를 쪼개서 송수신하고 수신지에서 재조립하며 패킷을 주고받는 '패킷 교환 네트워크'가 대부분이다.

하나의 패킷은 **페이로드(payload)** 와 **헤더(header)** 로 구성되어 있으며, 때로는 **트레일러(trailer)** 라는 정보가 포함되기도 한다.

**페이로드(payload)**: 실제 데이터

**헤더(header), 트레일러(trailer)**: 부가 정보

### 주소의 개념과 전송 방식

**주소(address)**: 네트워크상 두 호스트가 패킷을 주고받을 때 서로를 특정할 수 있는 정보로, 패킷의 헤더에 명시된다. 대표적인 주소로는 IP 주소와 MAC 주소가 있다.

수신지를 특정 호스트 하나로 지정할 수도 있고, 네트워크 내 모든 호스트로 지정할 수도 있다.

**유니캐스트(unicast)**: 송신지와 수신지가 일대일로 메시지를 주고받는 방식

**브로드캐스트(broadcast)**: 네트워크 상의 모든 호스트에게 메시지를 전송하는 방식. 브로드캐스트가 전송되는 범위를 **브로드캐스트 도메인** 이라고 하며, 호스트가 같은 브로드캐스트 도메인에 속해 있는 경우에는 같은 LAN에 속해 있다고 간주한다.

이 밖에도 네트워크 내 동일 그룹에 속한 호스트에게만 전송하는 **멀티캐스트**, 네트워크 내의 동일 그룹에 속한 호스트 중 가장 가까운 호스트에게 전송하는 **애니캐스트** 등 다양한 송수신 방식이 있지만, 유니캐스트와 브로드캐스트가 가장 자주 언급된다.

## 1-2. 두 호스트가 패킷을 주고받는 과정 (프로토콜 & 네트워크 참조 모델)

네트워크 내의 호스트가 서로 주고받을 내용(패킷)을 이해하고 올바르게 주고 받기 위해서는 해당 정보를 이해하기 위한 규칙인 **프로토콜** 과 **네트워크 참조 모델** 이 필요하다.

> 이번 장에서 알아볼 내용은 `프로토콜` 과 `네트워크 참조 모델` 이 두가지 틀에서 거의 모든게 진행된다.

### 프로토콜

호스트 뿐만 아니라 패킷이 거쳐 갈 네트워크 장비 역시 패킷의 내용을 이해할 수 있어야 하는데, 이를 위해 정한 규칙이 바로 프로토콜이다.

**프로토콜(protocol)**: 네트워크에서 통신을 주고 받는 노드 간의 합의된 규칙이나 방법을 말한다. 호스트와 네트워크 장비들이 서로 주고받는 정보를 이해하려면 같은 프로토콜로 통신해야 한다.

이번 장에서 알아볼 프로토콜 들의 예시:

```
IP	ARP	ICMP	TCP	UDP
DHCP	DNS	HTTP	SSL/TLS	HTTPS
...
```

각각의 프로토콜들은 다른 **목적**과 **특징**을 가진다.

### 네트워크 참조 모델

**네트워크 참조 모델(network reference model)**: 패킷을 주고받는 과정을 단계적이고 계층적으로 표현한 것. 패킷을 송신하는 쪽에서는 상위 계층에서 하위 계층으로 정보를 보내고, 패킷을 수신하는 쪽에서는 하위 계층에서 상위 계층으로 정보를 받아들인다.

(이해를 위한 그림)

네트워크 참조 모델에서 각각의 계층이 하는 일은 명확하게 정해져 있다. 따라서 계층별 목적에 맞는 프로토콜과 장비를 구성하면 네트워크의 구성과 설계, 문제의 진단과 해결이 용이해진다.

대표적인 네트워크 참조 모델로 **OSI 모델** 과 **TCP/IP** 모델이 있다.

### OSI 모델

**OSI 모델**: 국제 표준화 기구(ISO, International Organization for Standardization)에서 만든 네트워크 참조 모델로, 통신 단계를 7개의 계층으로 나눠 OSI 7 계층이라고 부른다.

(그림)

1. **물리 계층(physical layer)**: 가장 최하의 계층으로, 비트 신호를 주고받는 계층. 컴퓨터는 0과 1만을 이해할 수 있기 때문에 네트워크를 통해 주고받는 정보 또한 0과 1로 이루어진 신호로 구성된다.
2. **데이터 링크 계층(data link layer)**: 같은 LAN에 속한 호스트끼리 올바르게 정보를 주고받기 위한 계층. 이를 위해 같은 네트워크에 속한 호스트를 식별할 수 있는 주소(MAC 주소)를 사용하고, 물리 계층을 통해 주고받는 정보에 오류가 없는지 확인하기도 한다.
3. **네트워크 계층(network layer)**: LAN 을 넘어 다른 네트워크와 통신을 주고받기 위한 계층. 따라서 네트워크간 통신 과정에서 호스트를 식별할 수 있는 IP 주소가 필요하며, 이 계층에서 사용되는 대표적인 프로토콜이 IP이다.
4. **전송 계층(transport layer)**: 네트워크간 송수신되는 패킷이 유실되거나 순서가 뒤바뀔 때를 대비해 신뢰성 있는 전송을 가능하게 하는 계층. 또한 포트(port) 라는 정보를 통해 특정 응용 프로그램과의 연결 다리 역할을 수행하는 계층이기도 하며, 전송 계층에 속한 대표적인 프로토콜에는 TCP와 UDP가 있다.
5. **세션 계층(session layer)**: 응용 프로그램 간의 연결 상태인 세션(session)을 관리하기 위한 계층. 응용프로그램 간의 연결 상태를 유지하거나 새롭게 생성하고, 필요하다면 연결을 끊는 역할을 한다.
6. **표현 계층(presentation layer)**: 인코딩, 압축, 암호화와 같은 작업을 구행하는 계층. 세션 계층과 표현 계층은 다른 계층과 달리 두 계층을 명확하게 구분하지 않거나 응용 계층에 포함하여 간주하는 경우가 많다.
7. **응용 계층(application layer)**: 사용자와 가장 밀접하게 맞닿아 있어 여러 네트워크 서비스를 제공하는 계층으로 HTTP, HTTPS, DNS 등의 프로토콜이 응용 계층에 속한다.

### TCP/IP 모델

OSI 모델이 주로 네트워크의 이론적 기술을 목적으로 사용하는 반면, **TCP/IP 모델**은 구현과 프로토콜에 중점을 둔 네트워크 참조 모델이다. **TCP/IP 4계층** 이라고도 불리며 네트워크 액세스 계층, 인터넷 계층, 전송 계층, 응용 계층으로 구성되어 있다.

1. **네트워크 액세스 계층(network access layer)**: **링크 계층(link layer)**, **네트워크 인터페이스 계층(network interface layer)** 이라고도 불리며, OSI 모델의 데이터 링크 계층과 유사하다. TCP/IP 모델에는 OSI 모델에서의 물리 계층에 해당하는 개념이 없다고 보는 견해도 있다.
2. **인터넷 계층(internet layer)**: OSI 모델의 네트워크 계층과 유사하다.
3. **전송 계층(transport layer)**: OSI 모델에서 전송 계층과 유사하다.
4. **응용 계층(application layer)**: OSI 모델의 세션 계층, 표현 계층, 응용 계층을 합친 것과 유사하다.

### TCP/IP 모델 확장 (이 장의 관점)

여기서는 다른 여러 전공 서적에서 서술하는 방식을 차용하여 TCP/IP 모델에 물리 계층을 추가한 확장된 모델로써 네트워크를 설명한다. 유무선 통신 매체를 통해 신호를 주고받는 '물리 계층'부터 사용자 및 사용자 프로그램과 가장 가까이 맞닿아 있는 '응용 계층'까지 점차 계층을 올라가며 설명할 계획이다.

(그림)

### 캡슐화와 역캡슐화

프로토콜과 네트워크 참조 모델을 토대로 이뤄지는 패킷의 송수신 과정 중 송신 과정에서는 캡슐화가 이루어지고, 수신 과정에서 역캡슐화가 이루어진다. 각 계층에서는 어떤 정보를 송신할 때 상위 계층으로부터 내려받은 패킷을 페이로드 삼아, 각 계층에 포함된 프로토콜의 각기 다른 목적과 특징에 따라 헤더 혹은 트레일러를 덧붙인 다음 하위 계층으로 전달한다.

**캡슐화(encapsulation)**: 상위 계층의 패킷이 하위 계층의 페이로드로 간주되어 송신 과정에서 헤더(및 트레일러)를 추가해 나가는 과정

**역캡슐화(decapsulation)**: 캡슐화 과정에서 붙인 헤더(및 트레일러)를 각 계층에서 확인한 뒤 제거하는 과정

OSI모델 기준 계층마다 패킷을 부르는 이름. (각 계층에서 주고받는 패킷(메시지)을 지칭하는 이름이 다르다.)

| 계층             | 패킷의 이름                                                                                |
| :--------------- | :----------------------------------------------------------------------------------------- |
| 그 이상의 계층   | **데이터(data)** 또는 **메시지(message)**                                     |
| 전송 계층        | TCP기반 패킷:**세그먼트(segment)**<br />UDP기반 패킷: **데이터그램(datagram)** |
| 네트워크 계층    | **패킷**(이하 IP 패킷) 또는 데이터그램                                               |
| 데이터 링크 계층 | **프레임(frame)**                                                                    |
| 물리 계층        | **심볼(symbol)** 또는 **비트(bit)**                                           |

네트워크 계층 구조상 캡슐화와 역캡슐화 과정

(그림)

# 2. 물리계층과 데이터 링크 계층

목차:

1. 이더넷
2. 이더넷 프레임
3. 통신 매체
4. 네트워크 장비 (네트워크 인터페이스: NIC, 허브와 스위치)

## 2-1. 이더넷

물리 계층과 데이터 링크 계층에는 LAN 내의 호스트들이 올바르게 정보를 주고받을 수 있게 해주는 다양한 기술들이 포함되어 있는데, 그 기술의 예시가 이더넷이다.

**이더넷(Ethernet)**: 통신 매체를 통해 신호를 송수신하는 방법, 데이터 링크 계층에서 주고받는 데이터(프레임) 형식 등이 정의된 기술. 현대 대부분의 (유선)LAN은 이더넷을 기반으로 구현되어 있다.

이더넷 표준에 관한 내용은 지면상 생략

## 2-2. 이더넷 프레임

**이더넷 프레임(Ethernet frame)**: 이더넷 기반의 네트워크에서 주고받는 프레임을 말한다.

(그림)

1~3: 헤더, 4: 페이로드, 5: 트레일러

1. **프리앰블(preamble)**: 송수신지 동기화를 위해 사용되는 8바이트 크기의 정보로, 프리앰블의 첫 7바이트는 `10101010` 이라는 값을 갖고, 마지막 바이트는 `10101011` 이라는 값을 갖는다. 수신지는 이 프리앰블 비트를 통해 현재의 이더넷 프레임이 수신되고 있다는 사실을 알게 된다.
2. **MAC 주소(mac address)**: 송신지와 수신지를 특정할 수 있는 6바이트 길이의 MAC 주소가 명시되며, 다음과 같이 콜론(:)으로 구분된 12자리 16진수로 구성되어 있다. `ab:cd:ab:cd:00:01`
3. **타입/길이(type/length)**: 이 필드에 명시된 크기가 1500 이하 (16진수 05DC)이면 이 필드는 프레임의 길이를 나타내고, 1536 이상 (16진수 0600) 이면 타입을 나타낸다. 타입은 캡슐화된 상위 계층의 정보를 의미하기 때문에 어떤 상위 계층 프로토콜이 캡슐화되었는지 알 수 있는데, IPv4가 캡슐화되있다면 이 필드에는 16진수 0800이 명시되있고, ARP 프로토콜이 캡슐화되있다면 이 필드에는 16진수 0806이 명시된다.
4. **데이터**: 데이터 필드에는 페이로드가 명시된다. 데이터의 최대크기는 1500바이트로 제한되어 있으며, 이 크기를 **MTU**라고 부른다.
5. **FCS(Frame Check Sequence)**: 프레임의 오류가 있는지의 여부를 확인하기 위한 필드로, **CRC(Cyclic Redundancy Check)** 라는 오류 검출용 값이 명시된다.

## 2-3. 유무선 통신 매체

### 유선 매체 - 트위스티드 페어 케이블

**트위스티드 페어 케이블(twisted pair cable)**: 두 가닥씩 꼬아져 있는 구리선을 통해 전기적으로 신호를 주고받는 통신 매체. 트위스티드 페어 케이블의 성능은 카테고리에 따라 Cat5(100Mbps), Cat6(1Gbps), ... Cat8(40Gbps) 로 나뉜다. 잡음(노이즈)을 줄이기 위해 철사나 포일로 감싸는 경우가 많으며, 포일 실드로 노이즈를 감소시킨 케이블을 **FTP(Foil Twisted Pair)** 케이블, 아무것도 감싸지 않은 케이블은 **UTP(Unshielded Twisted Pair)** 케이블이라고 부른다.

### 무선 매체 - 전파와 WiFi

대표적인 유선 매체가 트위스티드 페어 케이블이라면, 대표적인 무선 매체는 **전파**다.전파는 약 3kHz 부터 3THz 사이의 진동수를 갖는 전자기파를 의미하며, 개발자가 전파 통신의 물리학적 원리를 이해해야 할 일은 많지 않지만 진동수 2.4GHz 와 5GHz 정도는 알아두는 것이 좋다.

이 때 같은 주파수 대역인 2.4GHz, 5GHz 에서 해당 주파수 대역을 사용하는 여러 무선 네트워크가 존재할 수 있는데, 같은 대역을 사용하는 서로 다른 무선 네트워크를 구분하기 위해 **채널(channel)** 이라는 하위 주파수 대역으로 세분화하고, 해당 채널 대역에서 무선 통신이 이루어진다. (20MHz 정도로 채널을 구분하는 것이 신호가 중첩될 여지가 없다.)

## 2-4. 네트워크 장비

### 네트워크 인터페이스: NIC

**네트워크 인터페이스(network interface)**: 네트워크 상에서 노드와 통신 매체가 연결되는 지점. 네트워크 인터페이스는 노드와 네트워크 사이의 통로와도 같다. 네트워크 인터페이스마다 물리적 주소라고 불리는 MAC 주소가 부여되고, **NIC(Network Interface Controller)** 라는 하드웨어가 네트워크 인터페이스의 역할을 담당하는 것이 일반적이다.

**NIC(Network Interface Controller)**:  통신 매체의 신호를 호스트가 이해하는 프레임으로 변환하거나 호스트가 이해하는 프레임을 통신 매체의 신호로 변환하는 역할을 수행한다. 네트워크 인터페이스 카드, 네트워크 어댑터, LAN 카드, 네트워크 카드, (이더넷 네트워크의 경우) 이더넷 카드 등 다양한 명칭으로 불린다.

### 허브와 스위치

허브와 스위치는 물리 계층과 데이터 링크 계층의 중간 노드이다. 허브는 오늘날 잘 사용하지 않지만 전이중/반이중 통신, 브로드캐스트 통신의 특징을 잘 보여주기 때문에 오늘날 많은 전공 서적에서 허브에 대해 설명한다.

#### 물리 계층의 허브

허브의 2가지 특징

1. 브로드캐스트: 허브는 전달 받은 신호를 어떠한 조작이나 판단도 하지 않고 모든 포트에 단순하게 신호를 내보낸다.
2. 반이중 통신: **반이중(half duplex)** 모드란 

# 3. 네트워크 계층 - IP

## 3-1. IP의 목적과 특징

## 3-2. IP 주소의 구조

## 3-3. 공인 IP 주소와 사설 IP 주소

## 3-4. IP 주소의 할당

## 3-5. IP 전송 특징의 보완: ICMP

## 3-6. IP 주소와 MAC 주소의 대응: ARP

# 4. 전송 계층 - TCP와 UDP

## 4-1. TCP와 UDP의 목적과 특징

## 4-2. TCP의 연결부터 종료까지

## 4-3. TCP의 상태 관리

# 5. 응용 계층 - HTTP의 기초

## 5-1. DNS와 URI/URL

## 5-2. HTTP의 특징과 메시지 구조

## 5-3. HTTP 메서드와 상태 코드

## 5-4. HTTP 주요 헤더

# 6. 응용 계층 - HTTP의 응용

## 6-1. 쿠키

## 6-2. 캐시

## 6-3. 콘텐츠 협상

## 6-4. 보안: SSL/TLS와 HTTPS

# 7. 프록시와 안정적인 트래픽

## 7-1. 오리진 서버와 중간 서버: 포워드 프록시와 리버스 프록시

## 7-2. 고가용성: 로드 밸런싱과 스케일링

## 7-3. Nginx로 알아보는 로드 밸런싱
